import pandas as pd
import sqlalchemy

def get_server(query, server, database):
    engine = sqlalchemy.create_engine(f'mssql+pyodbc://{server}/{database}?Trusted_Connection=yes&driver=SQL+Server')
    with engine.connect() as conn:
        df = pd.read_sql_query(query, conn)
    engine.dispose()
    return df


tank = 'TC10'
start_date = '2024-10-01'

content = f'''
    SELECT 
        *
    FROM 
        Summary_Daily_AVG_TC_PEM_Melting_1 a
    WHERE 
        a.TANK_ID = '{tank}'
'''
df = get_server(content, 'TCF11SQL2011', 'PI_REPLICATION')
print(df)
